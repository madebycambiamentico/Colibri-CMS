!function(){function e(){BUSY.start(),$.post("database/article-quick-edit.php",$("#edit-article").serialize(),null,"json").done(function(e){if(e.error)return alert("ERRORE:\n"+e.error);$("#art-"+e.id+" input.quick-mod").data({idx:e.idx,mnu:e.mnu,img:e.img,idxl:e.idxl,lang:e.lang}),e.img?$("#art-"+e.id+" label.art-img").css("background-image","url('img/thumbs/"+printAttr(e.img)+"')"):$("#art-"+e.id+" label.art-img").css("background-image","");var t=' <i class="art-type">('+printText(artTypes[$("#art-"+e.id+" .art-props h4").data("t")].n)+")</i>";$("#art-"+e.id+" .art-props h4").text(e.title).append(t),$("#art-"+e.id+" .art-desc").text(e.desc),$("#art-"+e.id).setFigureTitle(e.title,e.desc),$("#quick-edit-art").modalbox("off")}).fail(function(e){console.log(e),alert("Oooops!")}).always(function(){BUSY.end(),$.get("sitemap-generator-generic.php").always(function(e){console.log(e)})})}function t(e){if(!e||"garbage=1"==e)return!1;BUSY.start();var t=$.isArray(e)?ISGARBAGE?{trash:e,isgarbage:!0}:{trash:e}:e;$.post("database/article-garbage.php",t,null,"json").done(function(t){return t.error?alert("ERRORE:\n"+t.error):(e="#art-"+t.ids.join(",#art-"),void $(e).remove())}).fail(function(e){console.log(e),alert("Oooops!")}).always(function(){BUSY.end(),ISGARBAGE||$.get("sitemap-generator-generic.php").always(function(e){console.log(e)})})}function r(e){if(!e||"garbage=1"==e)return!1;BUSY.start();var t=$.isArray(e)?{trash:e}:e;$.post("database/article-resurrect.php",t,null,"json").done(function(t){return t.error?alert("ERRORE:\n"+t.error):(e="#art-"+t.ids.join(",#art-"),void $(e).remove())}).fail(function(e){console.log(e),alert("Oooops!")}).always(function(){BUSY.end()})}$.fn.setFigureTitle=function(e,t){return this.each(function(){$(this).attr("data-t",e?e.toLowerCase():$(this).find(".art-props h4").text().toLowerCase()).attr("data-c",t?t.toLowerCase():$(this).find(".art-desc").text().toLowerCase())})},$.fn.quickEdit=function(){return this.change(function(){var e=this.value,t=$(this).data();$("#eart-id").val(e),$("#eart-wasindex").val(t.idx),$("#eart-wasindexlang").val(t.idxl),$("#eart-isinmenu").prop("checked",t.mnu),$("#eart-isindex").prop("checked",t.idx),$("#eart-isindexlang").prop("checked",t.idxl),$("#eart-lang").val(t.lang),$("#eart-image").val(t.img),$("#eart-title").val($($("#art-"+e+" .art-props h4").contents()[0]).text().trim()).change(),$("#eart-desc").val($("#art-"+e+" .art-desc").text()),a.setPrefix(t.t+""),$("#quick-edit-art").modalbox()})},$.fn.quickDel=function(){return this.click(function(){var e=$(this).data("id");ISGARBAGE?"Verrà eliminato definitivamente e non sarà più recuperabile.":"L'articolo sarà ancora disponibile nel cestino se cambi idea.";return confirm("Sei sicuro di voler cancellare l'articolo \""+$("#art-"+e+" .art-props h4").text()+'"?\n')?void t([e]):!1})},$.fn.quickResurr=function(){return this.click(function(){var e=$(this).data("id");r([e])})};var a={date:$("#eart-smart-date").val(),prefix:"",setPrefix:function(e){return $("#eart-type").val(e),1==e?a.prefix="":a.prefix=artTypes[e].pfx+"/",a.update($("#eart-title").val())},update:function(e){return e=removeDiacritics(e).replace(/\s+|['"]+/g,"-").replace(/[?:;"#\\\/]/g,"").toLowerCase(),$("#eart-smart-1").val(a.prefix+e),a}},i={f_type:"",f_title:"",f_desc:"",setTitle:function(e){return""===e?i.f_title="":i.f_title='[data-t*="'+printAttr(e)+'"]',i.checkFilter(),this},setDesc:function(e){return""===e?i.f_desc="":i.f_desc='[data-c*="'+printAttr(e)+'"]',i.checkFilter(),this},setType:function(e){return"0"===e?i.f_type="":i.f_type=".type-"+e,i.checkFilter(),this},checkFilter:function(){return""===i.f_type&&""===i.f_title&&""===i.f_desc?$("#all-articles").removeClass("filtering"):($("#all-articles").addClass("filtering"),i.updateSearch()),updateView(),this},updateSearch:function(){return $("#all-articles .art-cont").removeClass("show"),$("#all-articles .art-cont"+i.f_type+i.f_title+i.f_desc).addClass("show")}};$(function(){$("#eart-title").change(function(){a.update(this.value)}),updateView("#all-articles",!0),$("#all-articles .art-cont").setFigureTitle(),$("#filtertype").change(function(){i.setType(this.value)}),$("#search-title").keyup(function(){i.setTitle(this.value)}),$("#search-desc").keyup(function(){i.setDesc(this.value)}),$("#sel-all").change(function(){$("#all-articles .art-img input").prop("checked",!1),$("#all-articles .art-cont"+i.f_type+i.f_title+i.f_desc+" .art-img input").prop("checked",!0)}),$("#desel-all").change(function(){$("#all-articles .art-img input").prop("checked",!1)}),$("#del-all").change(function(){var e=ISGARBAGE?"Verranno eliminati definitivamente e non saranno più recuperabili.":"Saranno ancora disponibili nel cestino se cambi idea.";return confirm("Sei sicuro di voler cancellare tutti gli articoli selezionati?\n"+e)?void t($("#my-article").serialize()):!1}),$("#resurr-all").change(function(){r($("#my-article").serialize())}),$(".quick-mod").quickEdit(),$(".quick-delete").quickDel(),$(".resurrect").quickResurr(),$("#saveArctic").click(e),$("#eart-fm-1").click(function(){FM_LISTENER=1,openFM("image")}),$("#eart-fm-1-del").click(function(){$("#eart-image").val("")})})}();